{"tagline":"A shell script for cron based version control deployments and security scans of WordPress.","google":"","note":"Don't delete this file! It's used internally to help with page regeneration.","name":"WordPress Security and GIT/SVN Deployment Script","body":"## Summary\r\n\r\nThis script was written to quickly and easily set up automated deployment and security scanning of WordPress installs. The idea is that if you have your WordPress install set up on GIT or SVN, you can use this script to regularly update and secure your site(s).\r\n\r\n* Uses SVN or GIT to make sure no rogue files exist in an install\r\n* Removes PHP,HTML and HTM files from writable directories such as blogs.dir and uploads.\r\n* Updates and maintains file and folder permissions and ownership.\r\n* Fully configurable.\r\n* Effectively acts as a deployment system. Every time you run the script, your version controlled code is deployed.\r\n\r\nVersion 2012.10.14\r\n\r\n## Important Warning!!!\r\n\r\nThis script will delete files and folders. If you do not configure your repository and this script correctly you can irreparably damage your website. We are not responsible for catastrophes caused by the mis-use (or use) of this script.\r\n\r\nTo best ensure that your system does not suffer from damage due to file deletions, make sure that you BACK UP YOUR ENTIRE WEBROOT before running this script.\r\n\r\nAlso, it is essential that your GIT/SVN ignore configuration is maintained. This script ASSUMES THAT UNVERSIONED FILES THAT ARE NOT IGNORED SHOULD BE DELETED.\r\n\r\nFor example, it is essential that at a minimum, the following is in your ignore configuration:\r\n\r\n* wp-config.php\r\n* wp-content/uploads\r\n\r\nDepending on your configuration, you may also need to ignore other files & folders such as .htaccess, wp-content/cache, wp-content/blogs.dir, wp-content/advanced-cache.php, etc...\r\n\r\n## Usage\r\n\r\n`bash mydomain.security-scan.sh`\r\n\r\nIn some cases, 'bash' doesn't work and in stead you would invoke the script like this:\r\n\r\n`. mydomain.security-scan.sh`\r\n\r\nIt is recommended that you set this up on a crontab so that the scan is regularly performed. Ideally the script lives outside of your webroot directory. See installation for more details.\r\n\r\n## Todo\r\n\r\n* Possibly scan wp-config.php and .htaccess for security\r\n* Possibly update the lib script to also accept parameters as arguments so that the config file is optional and the lib script can be executed directly.\r\n\r\n## Installation\r\n\r\nThese instructions assume that you have basic *nix systems skills. If you read through this and feel totally confused, then you should probably seek some professional help in installing this.\r\n\r\nAlthough this script is flexible enough to be configured and used in a variety of ways. Here's how we prefer to install it:\r\n\r\n# Install your Versioned Code\r\n\r\nBefore we do anything with this script, we're making some assumptions about your code setup. In particular, we're assuming that you've got your WordPress code in either GIT or SVN version control and that you've checked out that code into your webroot on your server.\r\n\r\nAs per our Important Warning above, we're also assuming that you've got proper GIT/SVN ignore configurations so that when the site is running, there are NO UNVERSIONED FILES aside from ones that you've explicitly ignored.\r\n\r\nThis script supports traditional WordPress configurations as well as @markjaquith's Skeleton configuration.\r\n\r\n# Download the Script onto Your Server\r\n\r\nChange directories to the folder above the webroot.\r\n\r\n`cd /path/above/your/webroot`\r\n\r\nMake a folder called scripts to hold this script and any others you might want to run.\r\n\r\n`mkdir scripts`\r\n\r\nChange directories to your scripts folder.\r\n\r\n`cd scripts`\r\n\r\nInitialize GIT.\r\n\r\n`git init`\r\n\r\nCheckout the security scripts code.\r\n\r\n`git checkout git://github.com/moderntribe/WordPress-Security-Shell-Script.git security-script`\r\n\r\n# Set up a Local Config\r\n\r\nWhile still in the scripts folder, copy the sample script to a new file that you can configure for your website.\r\n\r\n`cp security-script/security-scan.config.sample.sh mydomain.security-scan.sh`\r\n\r\nEdit the file (I prefer to use Nano for this. You can choose to use whatever or even FTP and use your favorite file editor). The various configuration options are documented in the sample config file.\r\n\r\n`nano mydomain.security-scan.sh`\r\n\r\nDefine at least ROOT_DIR, WRITEABLE_DIRS and the last line in the script where we include the library. You might also want to define KILL_GITLOCK as true to ensure that this script never gets locked out of making GIT updates.\r\n\r\n# Test the Script\r\n\r\nBackup your webroot incase the script messes things up.\r\n\r\n`cp -rfp /path/to/your/webroot /path/to/your/webroot.bk`\r\n\r\nRun the script (not this should be running the copy you made).\r\n\r\n`bash /path/above/your/webroot/scripts/mydomain.security-scan.sh`\r\n\r\n# Set up a Crontab\r\n\r\nOpen your cron for editing:\r\n\r\n`crontab -e`\r\n\r\nRun this every 5 minutes or so. You can also choose to output the results to a log file.\r\n\r\n*/5 * * * * bash /path/above/your/webroot/scripts/mydomain.security-scan.sh > /dev/null 2>&1\r\n\r\n## License\r\n\r\nCopyright Modern Tribe, Inc. (@moderntribeinc) 2012\r\n\r\nThis program is free software: you can redistribute it and/or modify it under the terms of the GNU General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.\r\n\r\nThis program is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License for more details.\r\n\r\nYou should have received a copy of the GNU General Public License along with this program.  If not, see [http://www.gnu.org/licenses/](http://www.gnu.org/licenses/).\r\n\r\n## Authors and Contributors\r\n\r\nAuthored by Chaim Peter Chester (@peterchester) with contributions from Daniel Dvorkin (@mzaweb) and Jonathan Brinley (@jbrinley).\r\n\r\n## Support or Contact\r\n\r\nThis code is unsupported and offered on an \"as is\" basis. If you would like support we recommend either asking about it on [Stack Overflow](http://stackoverflow.com/search?q=wordpress+security+scan) or entering an issue on [the github tracker](https://github.com/moderntribe/WordPress-Security-Shell-Script/issues)"}